:root {
    --ui-font: "Trebuchet MS", "Segoe UI", Tahoma, sans-serif;
    --math-font: "Cambria", "Times New Roman", serif;
    --accent-color: #1f2230;
    --clock-paper: #f7f7f8;
    --wall-light: #d5d7da;
    --wall-dark: #bfc2c6;
    --text-dark: #101010;
    --clock-scale: 1;
    --clock-size-base: min(58vh, 58vw, 560px);
    --clock-size: calc(var(--clock-size-base) * var(--clock-scale));
    --bg-overlay: 0.18;
    --bg-blur: 0px;
    --user-bg-image: none;
    --theme-text-color: #f4f7fb;
    --theme-border-color: rgba(255, 255, 255, 0.28);
}

* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    min-height: 100vh;
    font-family: var(--ui-font);
    overflow: hidden;
    color: var(--theme-text-color);
    background:
        linear-gradient(to right, transparent 0 16%, rgba(0, 0, 0, 0.14) 16.3% 16.5%, transparent 16.8% 33%, rgba(0, 0, 0, 0.16) 33.3% 33.5%, transparent 33.8% 50%, rgba(0, 0, 0, 0.11) 50.3% 50.5%, transparent 50.8% 67%, rgba(0, 0, 0, 0.13) 67.3% 67.5%, transparent 67.8%),
        linear-gradient(180deg, var(--wall-light), var(--wall-dark));
}

.background-video {
    position: fixed;
    inset: -2%;
    width: 104%;
    height: 104%;
    object-fit: cover;
    filter: blur(var(--bg-blur));
    transform: scale(1.06);
    opacity: 0;
    pointer-events: none;
    transition: opacity 180ms ease;
    z-index: -4;
}

body.has-custom-video .background-video {
    opacity: 1;
}

body::before {
    content: "";
    position: fixed;
    inset: -2%;
    background-image: var(--user-bg-image);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    filter: blur(var(--bg-blur));
    transform: scale(1.06);
    opacity: 0;
    transition: opacity 180ms ease;
    z-index: -3;
}

body.has-custom-bg::before {
    opacity: 1;
}

body::after {
    content: "";
    position: fixed;
    inset: 0;
    background: rgba(10, 16, 24, var(--bg-overlay));
    pointer-events: none;
    z-index: -2;
}

body.hide-google .google-header {
    display: none;
}

body.hide-google .newtab-app {
    padding-top: clamp(10px, 1.4vh, 16px);
}

body.hide-search .search-wrap {
    display: none;
}

body.hide-sites .quick-sites {
    display: none;
}

body.hide-sidebar .left-toolbar {
    transform: translate(-62px, -50%);
    opacity: 0;
    pointer-events: none;
}

body.hide-sidebar.sidebar-peek .left-toolbar,
body.hide-sidebar .left-toolbar:focus-within {
    transform: translate(0, -50%);
    opacity: 1;
    pointer-events: auto;
}

body.hide-notes .sticky-notes {
    display: none;
}

body.hide-clock .clock-area {
    visibility: hidden;
    pointer-events: none;
}

.newtab-app {
    min-height: 100vh;
    padding: clamp(62px, 8.5vh, 86px) clamp(10px, 2vw, 24px) clamp(20px, 3.2vh, 36px);
    display: grid;
    grid-template-rows: auto 1fr auto;
    gap: clamp(8px, 1.2vh, 14px);
    position: relative;
    z-index: 1;
}

.google-header {
    width: auto;
    max-width: calc(100vw - 20px);
    position: fixed;
    top: 12px;
    right: 14px;
    z-index: 24;
    display: flex;
    align-items: center;
    gap: 14px;
    justify-content: flex-end;
    padding: 7px 10px 7px 12px;
    border-radius: 14px;
    background: rgba(18, 34, 43, 0.34);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(6px);
}

.google-links {
    display: flex;
    align-items: center;
    gap: 14px;
}

.google-links a {
    color: #f4f7f8;
    text-decoration: none;
    font-size: 14px;
    font-weight: 600;
    font-family: var(--ui-font);
}

.google-links a:hover {
    text-decoration: underline;
}

.google-actions {
    display: flex;
    align-items: center;
    gap: 8px;
}

.icon-btn,
.avatar-btn,
.tool-btn,
.quick-actions button,
.search-submit,
.settings-group button,
.settings-footer button,
#closeSettingsBtn {
    border: none;
    cursor: pointer;
    font-family: inherit;
}

.icon-btn {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.17);
    color: #fff;
    display: grid;
    place-items: center;
}

.icon-btn svg {
    width: 18px;
    height: 18px;
    fill: currentColor;
}

.avatar-btn {
    width: 34px;
    height: 34px;
    border-radius: 50%;
    position: relative;
    overflow: hidden;
    font-size: 14px;
    font-weight: 700;
    color: #f2f8ff;
    border: 1px solid var(--theme-border-color);
    background: radial-gradient(circle at 35% 30%, rgba(124, 198, 255, 0.34), rgba(34, 54, 84, 0.78) 75%);
}

.avatar-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: none;
}

.avatar-letter {
    display: grid;
    place-items: center;
    width: 100%;
    height: 100%;
}

.avatar-btn.has-photo .avatar-image {
    display: block;
    object-position: center;
}

.avatar-btn.has-photo .avatar-letter {
    display: none;
}

.avatar-btn.has-photo {
    border-color: rgba(7, 221, 128, 0.88);
}

.apps-popover {
    position: absolute;
    top: calc(100% + 6px);
    right: 0;
    width: min(320px, 92vw);
    max-height: min(68vh, 560px);
    border-radius: 18px;
    overflow: auto;
    background: rgba(16, 24, 33, 0.42);
    border: 1px solid rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(14px);
    box-shadow: 0 18px 30px rgba(0, 0, 0, 0.28);
    padding: 10px 8px;
    z-index: 15;
}

.apps-popover.hidden {
    display: none;
}

.apps-grid {
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: 6px;
}

.apps-divider {
    grid-column: 1 / -1;
    height: 1px;
    margin: 8px 4px;
    background: rgba(255, 255, 255, 0.16);
}

.app-tile {
    text-decoration: none;
    color: #f4f8fd;
    border-radius: 14px;
    min-height: 76px;
    padding: 7px 5px;
    display: grid;
    align-content: center;
    justify-items: center;
    gap: 7px;
    background: rgba(255, 255, 255, 0.04);
    border: 1px solid transparent;
    transition: border-color 150ms ease, background 150ms ease, transform 150ms ease;
    cursor: pointer;
    user-select: none;
    position: relative;
}

.app-tile.edit-enabled {
    cursor: grab;
}

.app-tile:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.18);
    transform: translateY(-1px);
}

.app-tile.dragging {
    opacity: 0.52;
    transform: scale(0.96);
    cursor: grabbing;
}

.app-tile.drop-target {
    border-color: rgba(121, 199, 255, 0.95);
    background: rgba(121, 199, 255, 0.16);
}

.app-remove-btn {
    position: absolute;
    top: 4px;
    right: 4px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.35);
    background: rgba(204, 63, 63, 0.84);
    color: #fff;
    font-size: 12px;
    line-height: 1;
    font-weight: 700;
    cursor: pointer;
    display: grid;
    place-items: center;
}

.add-app-tile {
    border: 1px dashed rgba(255, 255, 255, 0.3);
    background: rgba(255, 255, 255, 0.05);
}

.add-app-tile:hover {
    border-color: rgba(255, 255, 255, 0.55);
    background: rgba(255, 255, 255, 0.13);
}

.add-app-icon-wrap {
    font-size: 30px;
    font-weight: 300;
    line-height: 1;
    color: #f5f9ff;
}

.add-app-icon {
    transform: translateY(-1px);
}

.app-icon-wrap {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: grid;
    place-items: center;
    background: rgba(255, 255, 255, 0.11);
}

.app-icon {
    width: 22px;
    height: 22px;
    object-fit: contain;
}

.app-icon.avatar-app-icon {
    border-radius: 50%;
}

.app-icon-fallback {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: rgba(16, 22, 31, 0.7);
    color: #f4f8fd;
    font-size: 12px;
    font-weight: 700;
    text-transform: uppercase;
    display: grid;
    place-items: center;
}

.app-label {
    font-size: 11px;
    font-weight: 600;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.search-wrap {
    width: 100%;
    display: grid;
    place-items: center;
    order: 2;
    margin-top: -2px;
}

.search-form {
    width: min(950px, 98%);
    min-height: 58px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.16);
    color: #f3f7fc;
    border: 1px solid rgba(255, 255, 255, 0.34);
    box-shadow: 0 10px 26px rgba(15, 20, 24, 0.24);
    backdrop-filter: blur(8px);
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px 8px 16px;
}

.search-icon {
    width: 20px;
    height: 20px;
    fill: none;
    stroke: rgba(239, 245, 252, 0.9);
    stroke-width: 2;
}

#searchInput {
    flex: 1;
    border: none;
    outline: none;
    font-size: clamp(15px, 1.7vw, 24px);
    color: #f8fbff;
    background: transparent;
}

#searchInput::placeholder {
    color: rgba(235, 241, 248, 0.82);
}

.search-submit {
    background: rgba(31, 34, 48, 0.45);
    color: #f2f7ff;
    border: 1px solid rgba(255, 255, 255, 0.24);
    border-radius: 999px;
    padding: 10px 16px;
    font-size: 14px;
    font-weight: 700;
}

.left-toolbar {
    position: fixed;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    width: 44px;
    border-radius: 12px;
    background: rgba(12, 18, 25, 0.33);
    border: 1px solid rgba(255, 255, 255, 0.26);
    backdrop-filter: blur(9px);
    display: grid;
    justify-items: center;
    gap: 6px;
    padding: 8px 0;
    z-index: 8;
    transition: transform 300ms cubic-bezier(0.22, 1, 0.36, 1), opacity 220ms ease, background 180ms ease;
}

.sidebar-edge-trigger {
    position: fixed;
    left: 0;
    top: 0;
    bottom: 0;
    width: 16px;
    z-index: 7;
    pointer-events: none;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.12), rgba(255, 255, 255, 0));
    opacity: 0;
    transition: opacity 180ms ease;
}

body.hide-sidebar .sidebar-edge-trigger {
    pointer-events: auto;
    opacity: 0.24;
}

body.hide-sidebar.sidebar-peek .sidebar-edge-trigger {
    opacity: 0;
}

.weather-widget {
    position: fixed;
    left: 66px;
    top: 50%;
    transform: translateY(-50%) translateX(-14px);
    width: min(300px, calc(100vw - 84px));
    border-radius: 16px;
    padding: 10px;
    background: rgba(16, 24, 34, 0.32);
    border: 1px solid var(--theme-border-color);
    backdrop-filter: blur(12px);
    box-shadow: 0 16px 30px rgba(0, 0, 0, 0.26);
    z-index: 9;
    opacity: 0;
    pointer-events: none;
    transition: transform 240ms ease, opacity 240ms ease;
}

.weather-widget.open {
    transform: translateY(-50%) translateX(0);
    opacity: 1;
    pointer-events: auto;
}

.weather-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    margin-bottom: 8px;
}

.weather-header h4 {
    font-size: 14px;
    letter-spacing: 0.4px;
    text-transform: uppercase;
    color: var(--theme-text-color);
}

#closeWeatherBtn {
    width: 26px;
    height: 26px;
    border-radius: 50%;
    border: 1px solid var(--theme-border-color);
    background: rgba(255, 255, 255, 0.12);
    color: var(--theme-text-color);
    font-size: 12px;
    font-weight: 700;
    cursor: pointer;
}

.weather-main {
    border: 1px solid var(--theme-border-color);
    border-radius: 12px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.06);
}

.weather-temp {
    font-size: 34px;
    font-weight: 700;
    line-height: 1;
    color: var(--theme-text-color);
}

.weather-condition {
    margin-top: 6px;
    font-size: 14px;
    font-weight: 600;
    color: var(--theme-text-color);
}

.weather-location {
    margin-top: 4px;
    font-size: 12px;
    color: rgba(240, 246, 252, 0.88);
}

.weather-meta {
    margin-top: 8px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    font-size: 12px;
    color: rgba(240, 246, 252, 0.9);
}

.weather-forecast {
    margin-top: 8px;
    list-style: none;
    display: grid;
    gap: 6px;
}

.weather-forecast li {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 6px 8px;
    border-radius: 10px;
    border: 1px solid var(--theme-border-color);
    background: rgba(255, 255, 255, 0.05);
    font-size: 12px;
    color: var(--theme-text-color);
}

.tool-btn {
    width: 32px;
    height: 32px;
    border-radius: 8px;
    background: rgba(255, 255, 255, 0.16);
    border: 1px solid rgba(255, 255, 255, 0.22);
    color: #f6f9fc;
    display: grid;
    place-items: center;
}

.tool-btn svg {
    width: 17px;
    height: 17px;
    fill: none;
    stroke: currentColor;
    stroke-width: 2;
    stroke-linecap: round;
    stroke-linejoin: round;
}

.tool-btn:hover,
.icon-btn:hover,
.site-card:hover,
.quick-actions button:hover,
.settings-group button:hover,
.settings-footer button:hover,
.search-submit:hover,
#closeSettingsBtn:hover {
    filter: brightness(1.12);
}

.scene {
    width: 100%;
    justify-self: center;
    position: relative;
    min-height: clamp(350px, 54vh, 620px);
    display: grid;
    place-items: center;
    isolation: isolate;
    order: 1;
}

.wall-lines {
    display: none;
}

.sticky-notes {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 7;
}

.sticky-note {
    --note-rot: -2deg;
    position: absolute;
    width: 132px;
    min-height: 114px;
    padding: 12px 12px 18px;
    border-radius: 2px;
    background:
        linear-gradient(180deg, rgba(255, 255, 255, 0.34), rgba(255, 255, 255, 0) 22%),
        linear-gradient(180deg, #f0ebb6 0%, #e8e3aa 80%, #ddd68f 100%);
    border: 1px solid rgba(131, 123, 68, 0.24);
    color: #584f2f;
    font-family: var(--math-font);
    font-size: clamp(16px, 1.05vw, 19px);
    line-height: 1.22;
    box-shadow: 0 12px 18px rgba(0, 0, 0, 0.24), 0 1px 0 rgba(255, 255, 255, 0.5) inset;
    transform: rotate(var(--note-rot));
    transform-origin: center top;
    cursor: grab;
    pointer-events: auto;
    user-select: none;
    display: flex;
    flex-direction: column;
}

.sticky-note::before {
    content: "";
    position: absolute;
    left: 10px;
    top: -6px;
    width: 34px;
    height: 10px;
    border-radius: 3px;
    background: rgba(255, 255, 255, 0.34);
    box-shadow: 0 1px 0 rgba(0, 0, 0, 0.08);
}

.sticky-note::after {
    content: "";
    position: absolute;
    right: 0;
    bottom: 0;
    width: 14px;
    height: 14px;
    background: linear-gradient(135deg, rgba(106, 98, 56, 0.18), rgba(255, 255, 255, 0.52));
    clip-path: polygon(100% 0, 0 100%, 100% 100%);
}

.sticky-note.dragging {
    cursor: grabbing;
    filter: brightness(1.03);
}

.sticky-note.editing {
    box-shadow: 0 0 0 2px rgba(112, 230, 255, 0.7), 0 12px 20px rgba(0, 0, 0, 0.28);
}

.sticky-note-text {
    white-space: pre-wrap;
    word-break: break-word;
    min-height: 60px;
    height: 100%;
    flex: 1 1 auto;
    overflow: auto;
    outline: none;
}

.sticky-note.editing .sticky-note-text {
    cursor: text;
    user-select: text;
}

.sticky-note-text img {
    max-width: 100%;
    height: auto;
    border-radius: 6px;
    display: block;
    margin: 2px 0;
}

.sticky-note-text video {
    max-width: 100%;
    width: 100%;
    height: auto;
    border-radius: 8px;
    display: block;
    margin: 2px 0;
    background: rgba(0, 0, 0, 0.52);
}

.sticky-note-attachment {
    margin-top: 8px;
    border-radius: 10px;
    overflow: hidden;
    background: rgba(255, 255, 255, 0.1);
}

.sticky-note-attachment img,
.sticky-note-attachment video {
    width: 100%;
    max-height: min(42vh, 300px);
    object-fit: cover;
    display: block;
}

.sticky-note.has-attachment .sticky-note-text {
    margin-bottom: 2px;
}

.sticky-note.attachment-only {
    background: transparent;
    border: none;
    box-shadow: none;
    padding: 0;
    min-height: 0;
    width: auto;
}

.sticky-note.attachment-only::before,
.sticky-note.attachment-only::after {
    display: none;
}

.sticky-note.attachment-only .sticky-note-text {
    display: none;
}

.sticky-note.attachment-only .sticky-note-attachment {
    margin-top: 0;
    background: transparent;
}

.sticky-note.attachment-only .sticky-note-attachment img,
.sticky-note.attachment-only .sticky-note-attachment video {
    border-radius: 12px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.34);
}

.sticky-note-text mark {
    background: rgba(255, 241, 130, 0.74);
    color: #42391f;
    padding: 0 2px;
}

.sticky-note-text code {
    background: rgba(92, 79, 47, 0.12);
    border-radius: 4px;
    padding: 1px 4px;
    font-size: 0.88em;
}

.sticky-note.image-only {
    background: transparent;
    border: none;
    box-shadow: none;
    padding: 0;
    min-height: 0;
    width: auto;
}

.sticky-note.image-only::before,
.sticky-note.image-only::after {
    display: none;
}

.sticky-note.image-only .sticky-note-text {
    min-height: 0;
    overflow: visible;
}

.sticky-note-control {
    opacity: 0;
    pointer-events: none;
    transition: opacity 140ms ease;
}

.sticky-note-delete {
    position: absolute;
    top: 4px;
    right: 4px;
    width: 18px;
    height: 18px;
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    background: rgba(204, 63, 63, 0.92);
    color: #fff;
    font-size: 11px;
    font-weight: 700;
    line-height: 1;
    display: grid;
    place-items: center;
    cursor: pointer;
}

.sticky-note-image {
    position: absolute;
    top: 4px;
    right: 26px;
    min-width: 20px;
    height: 18px;
    border: 1px solid rgba(255, 255, 255, 0.52);
    border-radius: 8px;
    background: rgba(39, 60, 75, 0.92);
    color: #f3f7ff;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.2px;
    padding: 0 4px;
    cursor: pointer;
}

.sticky-note-rotate {
    position: absolute;
    left: 50%;
    top: -9px;
    width: 22px;
    height: 22px;
    border: 1px solid rgba(255, 255, 255, 0.5);
    border-radius: 50%;
    background: rgba(39, 60, 75, 0.88);
    color: #f3f7ff;
    font-size: 12px;
    display: grid;
    place-items: center;
    transform: translateX(-50%);
    cursor: grab;
}

.sticky-note-resize {
    position: absolute;
    border: none;
    background: transparent;
    padding: 0;
}

.sticky-note-resize::before {
    content: "";
    position: absolute;
    border-radius: 2px;
    opacity: 0.75;
}

.sticky-note-resize.dir-n,
.sticky-note-resize.dir-s {
    left: 14px;
    right: 14px;
    height: 8px;
}

.sticky-note-resize.dir-n {
    top: -4px;
    cursor: ns-resize;
}

.sticky-note-resize.dir-s {
    bottom: -4px;
    cursor: ns-resize;
}

.sticky-note-resize.dir-n::before,
.sticky-note-resize.dir-s::before {
    left: 0;
    right: 0;
    top: 3px;
    height: 2px;
    background: rgba(255, 255, 255, 0.58);
}

.sticky-note-resize.dir-e,
.sticky-note-resize.dir-w {
    top: 14px;
    bottom: 14px;
    width: 8px;
}

.sticky-note-resize.dir-e {
    right: -4px;
    cursor: ew-resize;
}

.sticky-note-resize.dir-w {
    left: -4px;
    cursor: ew-resize;
}

.sticky-note-resize.dir-e::before,
.sticky-note-resize.dir-w::before {
    top: 0;
    bottom: 0;
    left: 3px;
    width: 2px;
    background: rgba(255, 255, 255, 0.58);
}

.sticky-note-resize.dir-nw,
.sticky-note-resize.dir-ne,
.sticky-note-resize.dir-sw,
.sticky-note-resize.dir-se {
    width: 14px;
    height: 14px;
}

.sticky-note-resize.dir-nw {
    left: -4px;
    top: -4px;
    cursor: nwse-resize;
}

.sticky-note-resize.dir-ne {
    right: -4px;
    top: -4px;
    cursor: nesw-resize;
}

.sticky-note-resize.dir-sw {
    left: -4px;
    bottom: -4px;
    cursor: nesw-resize;
}

.sticky-note-resize.dir-se {
    right: -4px;
    bottom: -4px;
    cursor: nwse-resize;
}

.sticky-note-resize.dir-nw::before,
.sticky-note-resize.dir-ne::before,
.sticky-note-resize.dir-sw::before,
.sticky-note-resize.dir-se::before {
    inset: 2px;
    border: 1px solid rgba(255, 255, 255, 0.72);
    background: rgba(41, 59, 73, 0.62);
}

.sticky-note-resize.dir-se::after {
    content: "";
    position: absolute;
    right: 1px;
    bottom: 1px;
    width: 8px;
    height: 8px;
    border-right: 1px solid rgba(255, 255, 255, 0.8);
    border-bottom: 1px solid rgba(255, 255, 255, 0.8);
}

.sticky-note.image-only .sticky-note-resize.dir-n,
.sticky-note.image-only .sticky-note-resize.dir-s,
.sticky-note.image-only .sticky-note-resize.dir-e,
.sticky-note.image-only .sticky-note-resize.dir-w {
    display: none;
}

.sticky-note.image-only .sticky-note-rotate {
    top: -16px;
}

.sticky-note.image-only .sticky-note-delete {
    top: -12px;
    right: -12px;
}

.sticky-note.image-only .sticky-note-image {
    top: -12px;
    right: 10px;
}

.sticky-note.image-only .sticky-note-text img {
    border-radius: 10px;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.34);
}

.sticky-note-resize:hover::before,
.sticky-note-rotate:hover {
    opacity: 1;
    filter: brightness(1.08);
}

.sticky-note-rotate:active {
    cursor: grabbing;
}

.sticky-note-resize:active::before {
    background: rgba(112, 230, 255, 0.35);
}

.sticky-note.image-only .sticky-note-resize.dir-se {
    right: -8px;
    bottom: -8px;
}

.sticky-note.image-only .sticky-note-resize.dir-se::before {
    inset: 2px;
}

.sticky-note.image-only .sticky-note-resize.dir-se::after {
    right: 2px;
    bottom: 2px;
}

.sticky-note-resize.dir-se,
.sticky-note-resize.dir-sw,
.sticky-note-resize.dir-ne,
.sticky-note-resize.dir-nw {
    z-index: 3;
}

.sticky-note-resize.dir-e,
.sticky-note-resize.dir-w,
.sticky-note-resize.dir-n,
.sticky-note-resize.dir-s {
    z-index: 2;
}

.sticky-note.image-only .sticky-note-resize.dir-ne,
.sticky-note.image-only .sticky-note-resize.dir-nw,
.sticky-note.image-only .sticky-note-resize.dir-sw {
    display: none;
}

.sticky-note.image-only .sticky-note-resize.dir-se {
    display: block;
}

.sticky-note-resize.dir-se {
    border: none;
    background: transparent;
}

.sticky-notes.edit-mode .sticky-note-control {
    opacity: 1;
    pointer-events: auto;
}

.clock-area {
    position: relative;
    display: grid;
    place-items: center;
}

.clock-area::before,
.clock-area::after {
    display: none;
}

.clock-face {
    width: var(--clock-size);
    aspect-ratio: 1 / 1;
    border-radius: 50%;
    position: relative;
    background: radial-gradient(circle at 40% 22%, #ffffff 0 35%, var(--clock-paper) 74%, #eceef0 100%);
    box-shadow: 0 20px 36px rgba(0, 0, 0, 0.26), 0 2px 0 rgba(255, 255, 255, 0.8) inset;
    border: 1px solid rgba(0, 0, 0, 0.08);
    font-family: var(--math-font);
}

.numbers-container {
    position: absolute;
    inset: 0;
    color: var(--text-dark);
}

.number {
    position: absolute;
    width: 23%;
    max-width: 23%;
    left: 50%;
    top: 50%;
    text-align: center;
    font-size: clamp(14px, 1.15vw, 22px);
    line-height: 1.02;
    font-weight: 700;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.38);
    transform-origin: center center;
}

.frac,
.binom,
.stack-frac {
    display: inline-block;
    line-height: 0.78;
}

.derivative {
    font-size: 0.9em;
    vertical-align: text-top;
}

.number-12 {
    width: 15%;
    max-width: 15%;
    font-size: clamp(13px, 1.02vw, 20px);
    transform: translate(-50%, -50%) rotate(0deg) translateY(calc(var(--clock-size) * -0.42)) rotate(0deg);
}
.number-1  { transform: translate(-50%, -50%) rotate(30deg)  translateY(calc(var(--clock-size) * -0.41)) rotate(-30deg); }
.number-2  { transform: translate(-50%, -50%) rotate(60deg)  translateY(calc(var(--clock-size) * -0.385)) rotate(-60deg); }
.number-3  { transform: translate(-50%, -50%) rotate(90deg)  translateY(calc(var(--clock-size) * -0.365)) rotate(-90deg); }
.number-4  { transform: translate(-50%, -50%) rotate(120deg) translateY(calc(var(--clock-size) * -0.385)) rotate(-120deg); }
.number-5  {
    width: 22%;
    max-width: 22%;
    font-size: clamp(12px, 0.96vw, 18px);
    transform: translate(-50%, -50%) rotate(150deg) translateY(calc(var(--clock-size) * -0.41)) rotate(-150deg);
}
.number-6  {
    width: auto;
    max-width: none;
    transform: translate(-50%, -50%) rotate(180deg) translateY(calc(var(--clock-size) * -0.425)) rotate(-180deg);
}
.number-7  {
    width: 21%;
    max-width: 21%;
    transform: translate(-50%, -50%) rotate(210deg) translateY(calc(var(--clock-size) * -0.41)) rotate(-210deg);
}
.number-8  { transform: translate(-50%, -50%) rotate(240deg) translateY(calc(var(--clock-size) * -0.385)) rotate(-240deg); }
.number-9  { transform: translate(-50%, -50%) rotate(270deg) translateY(calc(var(--clock-size) * -0.365)) rotate(-270deg); }
.number-10 { transform: translate(-50%, -50%) rotate(300deg) translateY(calc(var(--clock-size) * -0.385)) rotate(-300deg); }
.number-11 {
    width: 22%;
    max-width: 22%;
    font-size: clamp(12px, 0.98vw, 19px);
    transform: translate(-50%, -50%) rotate(330deg) translateY(calc(var(--clock-size) * -0.41)) rotate(-330deg);
}

.hand {
    position: absolute;
    left: 50%;
    top: 50%;
    transform-origin: 50% calc(100% - 6px);
    border-radius: 999px;
    background: linear-gradient(180deg, #2f3344 0%, #1f2230 85%);
}

.hour-hand {
    width: clamp(10px, 1.1vw, 14px);
    height: calc(var(--clock-size) * 0.26);
    margin-left: calc(clamp(10px, 1.1vw, 14px) / -2);
    margin-top: calc(var(--clock-size) * -0.255);
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.3);
    z-index: 5;
}

.minute-hand {
    width: clamp(9px, 1vw, 13px);
    height: calc(var(--clock-size) * 0.38);
    margin-left: calc(clamp(9px, 1vw, 13px) / -2);
    margin-top: calc(var(--clock-size) * -0.375);
    box-shadow: 0 7px 10px rgba(0, 0, 0, 0.32);
    z-index: 6;
}

.second-hand {
    width: clamp(2px, 0.24vw, 3px);
    height: calc(var(--clock-size) * 0.415);
    margin-left: calc(clamp(2px, 0.24vw, 3px) / -2);
    margin-top: calc(var(--clock-size) * -0.41);
    transform-origin: 50% calc(100% - 8px);
    background: linear-gradient(180deg, #df5858, #a31f1f);
    box-shadow: 0 0 8px rgba(185, 34, 34, 0.36);
    z-index: 8;
}

.clock-center {
    width: clamp(18px, 2vw, 24px);
    height: clamp(18px, 2vw, 24px);
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    border-radius: 50%;
    background: radial-gradient(circle at 35% 30%, #3f4558, #1d202d 70%);
    z-index: 10;
    box-shadow: 0 0 0 3px rgba(24, 26, 37, 0.4);
}

.clock-center::after {
    content: none;
}

.desk-shadow {
    display: none;
}

.quick-sites {
    width: min(1030px, 100%);
    justify-self: center;
    background: transparent;
    border: none;
    backdrop-filter: none;
    padding: 0 0 clamp(8px, 1.6vh, 18px);
    order: 3;
}

.quick-actions button,
.settings-group button,
.settings-footer button,
#closeSettingsBtn {
    color: #f5f8fc;
    background: var(--accent-color);
    border-radius: 10px;
    padding: 8px 10px;
    font-size: 13px;
    font-weight: 700;
}

.site-grid {
    display: flex;
    flex-wrap: wrap;
    align-items: flex-start;
    justify-content: center;
    gap: 10px 16px;
}

.site-card {
    text-decoration: none;
    color: #f7f9fc;
    background: transparent;
    border: none;
    width: 90px;
    display: grid;
    justify-items: center;
    gap: 8px;
    padding: 2px;
    transition: transform 150ms ease;
    position: relative;
    cursor: pointer;
}

.site-card.edit-enabled {
    cursor: default;
}

.site-bubble {
    width: 46px;
    height: 46px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.14);
    border: 1px solid rgba(255, 255, 255, 0.25);
    display: grid;
    place-items: center;
    backdrop-filter: blur(5px);
}

.site-favicon {
    width: 24px;
    height: 24px;
    border-radius: 50%;
}

.site-fallback {
    width: 24px;
    height: 24px;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.32);
    color: #f6f8fb;
    display: grid;
    place-items: center;
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
}

.site-card-add {
    color: #f4f8fc;
    background: transparent;
    border: none;
    cursor: pointer;
}

.site-remove-btn {
    position: absolute;
    top: -2px;
    right: 6px;
    width: 19px;
    height: 19px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.36);
    background: rgba(204, 63, 63, 0.92);
    color: #fff;
    font-size: 12px;
    line-height: 1;
    font-weight: 700;
    cursor: pointer;
    display: grid;
    place-items: center;
    z-index: 2;
}

.site-card-add .site-bubble {
    font-size: 30px;
    line-height: 1;
    color: #eaf0f8;
}

.site-card-add .site-bubble span {
    margin-top: -2px;
}

.site-title {
    width: 100%;
    text-align: center;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    font-size: 12px;
    font-weight: 500;
    color: #eef3fa;
}

.site-empty {
    font-size: 12px;
    color: #e6ebf2;
    opacity: 0.86;
    text-align: center;
}

.settings-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: min(420px, 95vw);
    height: 100vh;
    overflow: auto;
    background: rgba(8, 12, 18, 0.58);
    border-left: 1px solid rgba(255, 255, 255, 0.24);
    backdrop-filter: blur(12px);
    color: #f7faff;
    transform: translateX(100%);
    transition: transform 220ms ease;
    z-index: 30;
    padding: 14px;
}

.settings-panel.open {
    transform: translateX(0);
}

.settings-header,
.settings-group,
.settings-footer {
    border: 1px solid rgba(255, 255, 255, 0.09);
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.02);
    margin-bottom: 10px;
    padding: 12px;
}

.settings-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.settings-header h3 {
    font-size: 18px;
}

.settings-group {
    display: grid;
    gap: 9px;
}

.settings-group h4 {
    font-size: 14px;
    opacity: 0.92;
    text-transform: uppercase;
    letter-spacing: 0.7px;
}

.settings-group label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
    font-size: 13px;
}

.settings-group input[type="checkbox"] {
    width: 16px;
    height: 16px;
    accent-color: var(--accent-color);
}

.settings-group input[type="range"] {
    width: 100%;
    accent-color: var(--accent-color);
}

.settings-group input[type="color"] {
    width: 100%;
    height: 36px;
    border: none;
    border-radius: 10px;
    background: transparent;
}

.button-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}

.value-badge {
    background: rgba(255, 255, 255, 0.18);
    border-radius: 999px;
    font-size: 12px;
    font-weight: 700;
    padding: 2px 8px;
}

.custom-sites-list {
    display: grid;
    gap: 6px;
}

.custom-site-item {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 8px;
    align-items: center;
    background: rgba(255, 255, 255, 0.08);
    border-radius: 10px;
    padding: 8px;
}

.custom-site-item span {
    font-size: 12px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.custom-site-item button {
    padding: 6px 8px;
    border-radius: 8px;
    background: rgba(220, 70, 70, 0.9);
    color: #fff;
    border: none;
    cursor: pointer;
    font-size: 12px;
}

.app-modal {
    position: fixed;
    inset: 0;
    z-index: 64;
    display: grid;
    place-items: center;
    padding: 14px;
    background: rgba(8, 12, 18, 0.34);
    backdrop-filter: blur(5px);
}

.app-modal.hidden {
    display: none;
}

.app-modal-card {
    width: min(520px, 92vw);
    border-radius: 16px;
    border: 1px solid rgba(255, 255, 255, 0.22);
    background: rgba(13, 20, 28, 0.52);
    backdrop-filter: blur(14px);
    box-shadow: 0 18px 32px rgba(0, 0, 0, 0.32);
    padding: 16px 16px 14px;
}

.app-modal-card h3 {
    font-size: 20px;
    margin-bottom: 10px;
    color: #f6f9ff;
}

.app-modal-form {
    display: grid;
    gap: 10px;
}

.app-modal-form label {
    font-size: 13px;
    font-weight: 600;
    color: rgba(238, 245, 255, 0.92);
}

.app-modal-form input {
    width: 100%;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.36);
    background: rgba(255, 255, 255, 0.1);
    color: #f8fbff;
    font-size: 15px;
    padding: 11px 12px;
    outline: none;
}

.app-modal-form input::placeholder {
    color: rgba(223, 233, 247, 0.7);
}

.app-modal-form input:focus {
    border-color: rgba(120, 222, 255, 0.95);
    box-shadow: 0 0 0 2px rgba(120, 222, 255, 0.2);
}

.app-modal-error {
    min-height: 16px;
    font-size: 12px;
    color: #ff9f9f;
}

.app-modal-actions {
    margin-top: 2px;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
}

.app-modal-btn {
    border: 1px solid rgba(255, 255, 255, 0.24);
    border-radius: 999px;
    padding: 10px 18px;
    font-size: 14px;
    font-weight: 700;
    cursor: pointer;
}

.app-modal-cancel {
    background: rgba(255, 255, 255, 0.16);
    color: #edf4ff;
}

.app-modal-confirm {
    background: rgba(112, 230, 255, 0.9);
    color: #0f2a36;
}

.toast {
    position: fixed;
    left: 50%;
    bottom: 16px;
    transform: translateX(-50%) translateY(120%);
    border-radius: 999px;
    background: rgba(18, 22, 28, 0.92);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #f8fafc;
    padding: 10px 14px;
    font-size: 13px;
    opacity: 0;
    transition: transform 220ms ease, opacity 220ms ease;
    z-index: 60;
}

.toast.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
}

.google-links a,
.app-label,
.site-title,
.site-empty,
.settings-panel,
.settings-header h3,
.settings-group h4,
.settings-group label,
.custom-site-item span,
.custom-site-item button,
#searchInput,
.search-submit,
.app-modal-card h3,
.app-modal-form label,
.app-modal-form input,
.app-modal-btn,
.toast,
.weather-widget,
.weather-widget button,
.weather-widget li {
    color: var(--theme-text-color);
}

#searchInput::placeholder,
.weather-location,
.weather-meta {
    color: var(--theme-text-color);
    opacity: 0.9;
}

.google-header,
.apps-popover,
.left-toolbar,
.tool-btn,
.search-form,
.site-bubble,
.site-remove-btn,
.settings-panel,
.settings-header,
.settings-group,
.settings-footer,
.custom-site-item,
.app-modal-card,
.app-modal-form input,
.app-modal-btn,
.app-tile,
.app-remove-btn,
.toast,
.sticky-note,
.sticky-note-delete,
.sticky-note-image,
.sticky-note-rotate,
.weather-widget,
.weather-main,
.weather-forecast li,
#closeWeatherBtn {
    border-color: var(--theme-border-color);
}

@media (max-width: 980px) {
    :root {
        --clock-size-base: min(56vh, 76vw, 480px);
    }

    .left-toolbar {
        left: 6px;
    }

    .google-links a {
        font-size: 14px;
    }

    .number {
        font-size: clamp(13px, 1.8vw, 22px);
    }

    .number-5,
    .number-11,
    .number-12 {
        font-size: clamp(12px, 1.4vw, 19px);
    }
}

@media (max-width: 760px) {
    :root {
        --clock-size-base: min(50vh, 84vw, 420px);
    }

    .newtab-app {
        padding: 60px clamp(10px, 2vw, 24px) clamp(18px, 3.4vh, 30px);
    }

    .left-toolbar {
        display: none;
    }

    .weather-widget {
        left: 10px;
        top: auto;
        bottom: 10px;
        transform: translateY(18px);
        width: min(320px, calc(100vw - 20px));
    }

    .weather-widget.open {
        transform: translateY(0);
    }

    .sticky-notes {
        display: none;
    }

    .google-header {
        right: 8px;
        top: 8px;
        padding: 6px 9px;
        gap: 10px;
    }

    .google-links {
        gap: 9px;
    }

    .google-links a {
        font-size: 13px;
    }

    .button-row {
        grid-template-columns: 1fr;
    }
}

@media (prefers-reduced-motion: reduce) {
    * {
        animation: none !important;
        transition: none !important;
    }
}
